parameters:
  - name: workingDirectory
    type: string
    default: "./"
  - name: runTests
    type: boolean
    default: true
  - name: runDocTests
    type: boolean
    default: true

steps:
  - template: rust-fmt-clippy.yml
    parameters:
      workingDirectory: ${{ parameters.workingDirectory }}

  - ${{ if parameters.runTests }}:
      - script: cargo test --verbose -- --nocapture
        displayName: Run tests
        workingDirectory: ${{ parameters.workingDirectory }}

  - ${{ if parameters.runDocTests }}:
      - script: cargo test --verbose --doc -- --no-capture
        displayName: Run doc tests
        workingDirectory: ${{ parameters.workingDirectory }}
