parameters:
  # The name of the project
  - name: projectName
    type: string
  # If the cargo registry folder should be cached
  - name: cacheRegistry
    type: boolean
    default: true
  # The working directory where your Cargo.toml is located. Defaults to the current directory
  - name: workingDirectory
    type: string
    default: "."

steps:
  - ${{ if parameters.cacheRegistry }}:
      - task: Cache@2
        inputs:
          key: '"rust-${{ parameters.projectName }}-cache" | "$(Agent.OS)" | "${{ parameters.workingDirectory }}/Cargo.toml"'
          path: $(HOME)/.cargo/registry
        displayName: Cache cargo cache folder
        continueOnError: true
  - task: Cache@2
    inputs:
      key: '"rust-${{ parameters.projectName }}-target" | "$(Agent.OS)" | "${{ parameters.workingDirectory }}/Cargo.toml"'
      path: $(working-directory)/target
    displayName: Cache target folder
    continueOnError: true
